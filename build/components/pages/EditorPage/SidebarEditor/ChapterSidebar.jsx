'use strict';exports.__esModule=true;var _assign=require('babel-runtime/core-js/object/assign');var _assign2=_interopRequireDefault(_assign);var _getPrototypeOf=require('babel-runtime/core-js/object/get-prototype-of');var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require('babel-runtime/helpers/classCallCheck');var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require('babel-runtime/helpers/createClass');var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require('babel-runtime/helpers/possibleConstructorReturn');var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require('babel-runtime/helpers/inherits');var _inherits3=_interopRequireDefault(_inherits2);var _class,_temp,_initialiseProps,_jsxFileName='components/pages/EditorPage/SidebarEditor/ChapterSidebar.jsx';var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactDom=require('react-dom');var _reactSortableHoc=require('react-sortable-hoc');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ChapterSidebar=(_temp=_class=function(_React$Component){(0,_inherits3.default)(ChapterSidebar,_React$Component);function ChapterSidebar(props){(0,_classCallCheck3.default)(this,ChapterSidebar);var _this=(0,_possibleConstructorReturn3.default)(this,(ChapterSidebar.__proto__||(0,_getPrototypeOf2.default)(ChapterSidebar)).call(this,props));_initialiseProps.call(_this);_this.state={showSearch:true,searchTerm:''};return _this}(0,_createClass3.default)(ChapterSidebar,[{key:'__shouldComponentUpdate__REACT_HOT_LOADER__',value:function __shouldComponentUpdate__REACT_HOT_LOADER__(){return this.__shouldComponentUpdate__REACT_HOT_LOADER__.apply(this,arguments)}},{key:'__shouldComponentUpdate__REACT_HOT_LOADER__',value:function __shouldComponentUpdate__REACT_HOT_LOADER__(nextProps,nextState){return this.props.selectedChapter!==nextProps.selectedChapter||this.props.searchTerm!==nextProps.searchTerm||this.props.book.draft.chapterList.join('')!==nextProps.book.draft.chapterList.join('')||this.props.book.draft.chapters!==nextProps.book.draft.chapters}},{key:'__onSortEnd__REACT_HOT_LOADER__',value:function __onSortEnd__REACT_HOT_LOADER__(){return this.__onSortEnd__REACT_HOT_LOADER__.apply(this,arguments)}},{key:'__onSortEnd__REACT_HOT_LOADER__',value:function __onSortEnd__REACT_HOT_LOADER__(_ref){var oldIndex=_ref.oldIndex,newIndex=_ref.newIndex;var chapterList=(0,_reactSortableHoc.arrayMove)(this.props.book.draft.chapterList,oldIndex,newIndex);var draft=(0,_assign2.default)({},this.props.book.draft);draft.chapterList=chapterList;this.props.methods.saveDraft(draft)}},{key:'__handleSearchClick__REACT_HOT_LOADER__',value:function __handleSearchClick__REACT_HOT_LOADER__(){return this.__handleSearchClick__REACT_HOT_LOADER__.apply(this,arguments)}},{key:'__handleSearchClick__REACT_HOT_LOADER__',value:function __handleSearchClick__REACT_HOT_LOADER__(){this.setState({showSearch:!this.state.showSearch})}},{key:'__handleSearchInputChange__REACT_HOT_LOADER__',value:function __handleSearchInputChange__REACT_HOT_LOADER__(){return this.__handleSearchInputChange__REACT_HOT_LOADER__.apply(this,arguments)}},{key:'__handleSearchInputChange__REACT_HOT_LOADER__',value:function __handleSearchInputChange__REACT_HOT_LOADER__(event){this.setState({searchTerm:event.target.value})}},{key:'__renderSearch__REACT_HOT_LOADER__',value:function __renderSearch__REACT_HOT_LOADER__(){return this.__renderSearch__REACT_HOT_LOADER__.apply(this,arguments)}},{key:'__renderSearch__REACT_HOT_LOADER__',value:function __renderSearch__REACT_HOT_LOADER__(){var _this2=this;return this.state.showSearch?_react2.default.createElement('div',{className:'chapter-search',__source:{fileName:_jsxFileName,lineNumber:102}},_react2.default.createElement('input',{type:'text',placeholder:'Search book...',onChange:this.handleSearchInputChange,value:this.state.searchTerm,__source:{fileName:_jsxFileName,lineNumber:103}}),_react2.default.createElement('i',{className:'icon ion-ios-close-outline',onClick:function onClick(){return _this2.setState({searchTerm:''})},__source:{fileName:_jsxFileName,lineNumber:109}})):null}},{key:'render',value:function render(){var _this3=this;console.log('Rendering BookEditChapterSidebar');return _react2.default.createElement('div',{className:'sidebar-chapters-container',__source:{fileName:_jsxFileName,lineNumber:120}},this.renderSearch(),_react2.default.createElement(this.SortableList,{chapterList:this.props.book.draft.chapterList,onSortEnd:this.onSortEnd,useDragHandle:true,__source:{fileName:_jsxFileName,lineNumber:122}}),_react2.default.createElement('div',{className:'chapter-action-icons',__source:{fileName:_jsxFileName,lineNumber:127}},_react2.default.createElement('button',{className:'btn-success',onClick:function onClick(){return _this3.props.methods.handleCreateChapter()},__source:{fileName:_jsxFileName,lineNumber:128}},'NEW'),_react2.default.createElement('button',{className:'btn-danger',onClick:function onClick(){return _this3.props.methods.handleDeleteChapter()},__source:{fileName:_jsxFileName,lineNumber:134}},_react2.default.createElement('i',{className:'icon ion-trash-b',__source:{fileName:_jsxFileName,lineNumber:138}}))))}}]);return ChapterSidebar}(_react2.default.Component),_class.displayName='ChapterSidebar',_initialiseProps=function _initialiseProps(){var _this4=this;this.shouldComponentUpdate=function(){return _this4.__shouldComponentUpdate__REACT_HOT_LOADER__.apply(_this4,arguments)};this.DragHandle=(0,_reactSortableHoc.SortableHandle)(function(){return _react2.default.createElement('span',{__source:{fileName:_jsxFileName,lineNumber:41}},_react2.default.createElement('i',{className:'icon ion-drag',__source:{fileName:_jsxFileName,lineNumber:42}}))});this.SortableItem=(0,_reactSortableHoc.SortableElement)(function(props){return _react2.default.createElement('li',{className:props.clKey===_this4.props.selectedChapter?'highlight':'',onClick:function onClick(){return _this4.props.methods.handleSelectChapter(props.clKey)},__source:{fileName:_jsxFileName,lineNumber:47}},_react2.default.createElement(_this4.DragHandle,{__source:{fileName:_jsxFileName,lineNumber:51}}),_this4.props.book.draft.chapters[props.clKey].title)});this.SortableList=(0,_reactSortableHoc.SortableContainer)(function(_ref2){var chapterList=_ref2.chapterList;return _react2.default.createElement('ul',{className:'chapter-list',__source:{fileName:_jsxFileName,lineNumber:62}},chapterList.map(function(clKey,index){return _react2.default.createElement(_this4.SortableItem,{key:clKey,index:index,clKey:clKey,__source:{fileName:_jsxFileName,lineNumber:64}})}))});this.onSortEnd=function(){return _this4.__onSortEnd__REACT_HOT_LOADER__.apply(_this4,arguments)};this.handleSearchClick=function(){return _this4.__handleSearchClick__REACT_HOT_LOADER__.apply(_this4,arguments)};this.handleSearchInputChange=function(){return _this4.__handleSearchInputChange__REACT_HOT_LOADER__.apply(_this4,arguments)};this.renderSearch=function(){return _this4.__renderSearch__REACT_HOT_LOADER__.apply(_this4,arguments)}},_temp);var _default=ChapterSidebar;exports.default=_default;;var _temp2=function(){if(typeof __REACT_HOT_LOADER__==='undefined'){return}__REACT_HOT_LOADER__.register(ChapterSidebar,'ChapterSidebar','components/pages/EditorPage/SidebarEditor/ChapterSidebar.jsx');__REACT_HOT_LOADER__.register(_default,'default','components/pages/EditorPage/SidebarEditor/ChapterSidebar.jsx')}();;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNoYXB0ZXJTaWRlYmFyLmpzeCJdLCJuYW1lcyI6WyJDaGFwdGVyU2lkZWJhciIsInByb3BzIiwic3RhdGUiLCJzaG93U2VhcmNoIiwic2VhcmNoVGVybSIsIm5leHRQcm9wcyIsIm5leHRTdGF0ZSIsInNlbGVjdGVkQ2hhcHRlciIsImJvb2siLCJkcmFmdCIsImNoYXB0ZXJMaXN0Iiwiam9pbiIsImNoYXB0ZXJzIiwib2xkSW5kZXgiLCJuZXdJbmRleCIsIm1ldGhvZHMiLCJzYXZlRHJhZnQiLCJzZXRTdGF0ZSIsImV2ZW50IiwidGFyZ2V0IiwidmFsdWUiLCJoYW5kbGVTZWFyY2hJbnB1dENoYW5nZSIsImNvbnNvbGUiLCJsb2ciLCJyZW5kZXJTZWFyY2giLCJvblNvcnRFbmQiLCJoYW5kbGVDcmVhdGVDaGFwdGVyIiwiaGFuZGxlRGVsZXRlQ2hhcHRlciIsIkNvbXBvbmVudCIsImRpc3BsYXlOYW1lIiwic2hvdWxkQ29tcG9uZW50VXBkYXRlIiwiRHJhZ0hhbmRsZSIsIlNvcnRhYmxlSXRlbSIsImNsS2V5IiwiaGFuZGxlU2VsZWN0Q2hhcHRlciIsInRpdGxlIiwiU29ydGFibGVMaXN0IiwibWFwIiwiaW5kZXgiLCJoYW5kbGVTZWFyY2hDbGljayJdLCJtYXBwaW5ncyI6Ink1QkFBQSw0QiwyQ0FDQSxtQ0FDQSxvRCxxRkFPTUEsZSxrR0FJSix3QkFBWUMsS0FBWixDQUFtQiw2TEFDWEEsS0FEVyxnQ0FHakIsTUFBS0MsS0FBTCxDQUFhLENBQ1hDLFdBQVksSUFERCxDQUVYQyxXQUFZLEVBRkQsQ0FBYixDQUhpQixZQU9sQixDLHdWQVF3QkMsUyxDQUFXQyxTLFFBQ2xDLE1BQUtMLEtBQUwsQ0FBV00sZUFBWCxHQUErQkYsVUFBVUUsZUFBekMsRUFDQSxLQUFLTixLQUFMLENBQVdHLFVBQVgsR0FBMEJDLFVBQVVELFVBRHBDLEVBRUMsS0FBS0gsS0FBTCxDQUFXTyxJQUFYLENBQWdCQyxLQUFoQixDQUFzQkMsV0FBdEIsQ0FBa0NDLElBQWxDLENBQXVD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RDZCLENBQWhCLEMsTUFjZkMsWSxDQUFlLHdDQUFrQixlQUFxQixJQUFsQjFCLFlBQWtCLE9BQWxCQSxXQUFrQixDQUNwRCxNQUNFLHFDQUFJLFVBQVUsY0FBZCxpREFDR0EsWUFBWTJCLEdBQVosQ0FBZ0IsU0FBQ0osS0FBRCxDQUFRSyxLQUFSLFFBQ2Ysc0NBQU0sWUFBTixFQUFtQixJQUFLTCxLQUF4QixDQUErQixNQUFPSyxLQUF0QyxDQUE2QyxNQUFPTCxLQUFwRCxpREFEZSxDQUFoQixDQURILENBTUgsQ0FSYyxDLE1BYWZSLFMsd0ZBY0FjLGlCLGdHQU1BbEIsdUIsc0dBTUFHLFksMkdBZ0RheEIsYyxvSUF6SVRBLGMiLCJmaWxlIjoiQ2hhcHRlclNpZGViYXIuanN4Iiwic291cmNlUm9vdCI6Ii9Vc2Vycy90b255bmd1eWVuL0RvY3VtZW50cy9HaXRIdWIvY29kZWZvcmFwcHMvdG9vbHMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgcmVuZGVyIH0gZnJvbSAncmVhY3QtZG9tJztcbmltcG9ydCB7XG4gIFNvcnRhYmxlQ29udGFpbmVyLFxuICBTb3J0YWJsZUVsZW1lbnQsXG4gIFNvcnRhYmxlSGFuZGxlLFxuICBhcnJheU1vdmVcbn0gZnJvbSAncmVhY3Qtc29ydGFibGUtaG9jJztcblxuY2xhc3MgQ2hhcHRlclNpZGViYXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuXG4gIHN0YXRpYyBkaXNwbGF5TmFtZSA9ICdDaGFwdGVyU2lkZWJhcic7XG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgc2hvd1NlYXJjaDogdHJ1ZSxcbiAgICAgIHNlYXJjaFRlcm06ICcnXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBOb3JtYWxseSB5b3Ugd291bGRuJ3Qgd2FudCB0byBqb2luIGFuIGFycmF5IGFzIGEgc3RyaW5nIGFuZCB0aGVuIGNvbXBhcmVcbiAgICogdGhlIHN0cmluZyB0byBzZWUgaWYgdGhlIGFycmF5IGhhcyBjaGFuZ2VkIChiZWNhdXNlIG9mIGVtcHR5IHN0cmluZ3MgYW5kXG4gICAqIG90aGVyIHZhcmlvdXMgcmVhc29ucykgYnV0IGluIHRoaXMgY2FzZSwgc2luY2Ugd2Uga25vdyBpdCdzIGEgaGV4IHN0cmluZ1xuICAgKiBpdCdzIG9rXG4gICAqL1xuICBzaG91bGRDb21wb25lbnRVcGRhdGUgPSAobmV4dFByb3BzLCBuZXh0U3RhdGUpID0+XG4gICAgdGhpcy5wcm9wcy5zZWxlY3RlZENoYXB0ZXIgIT09IG5leHRQcm9wcy5zZWxlY3RlZENoYXB0ZXIgfHxcbiAgICB0aGlzLnByb3BzLnNlYXJjaFRlcm0gIT09IG5leHRQcm9wcy5zZWFyY2hUZXJtIHx8XG4gICAgKHRoaXMucHJvcHMuYm9vay5kcmFmdC5jaGFwdGVyTGlzdC5qb2luKCcnKSAhPT1cbiAgICBuZXh0UHJvcHMuYm9vay5kcmFmdC5jaGFwdGVyTGlzdC5qb2luKCcnKSkgfHxcbiAgICB0aGlzLnByb3BzLmJvb2suZHJhZnQuY2hhcHRlcnMgIT09IG5leHRQcm9wcy5ib29rLmRyYWZ0LmNoYXB0ZXJzO1xuXG4gIC8qICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgKiBUaGlzIHNlY3Rpb24gb2YgY29tcG9uZW50cyBpcyBmb3IgaGFuZGxpbmcgZHJhZyBhbmQgZHJvcFxuICAgKi9cblxuICBEcmFnSGFuZGxlID0gU29ydGFibGVIYW5kbGUoKCkgPT5cbiAgICA8c3Bhbj5cbiAgICAgIDxpIGNsYXNzTmFtZT1cImljb24gaW9uLWRyYWdcIiAvPlxuICAgIDwvc3Bhbj5cbiAgKTtcblxuICBTb3J0YWJsZUl0ZW0gPSBTb3J0YWJsZUVsZW1lbnQoKHByb3BzKSA9PlxuICAgIDxsaVxuICAgICAgY2xhc3NOYW1lPXtwcm9wcy5jbEtleSA9PT0gdGhpcy5wcm9wcy5zZWxlY3RlZENoYXB0ZXIgPyAnaGlnaGxpZ2h0JyA6ICcnfVxuICAgICAgb25DbGljaz17KCkgPT4gdGhpcy5wcm9wcy5tZXRob2RzLmhhbmRsZVNlbGVjdENoYXB0ZXIocHJvcHMuY2xLZXkpfVxuICAgID5cbiAgICAgIDx0aGlzLkRyYWdIYW5kbGUgLz5cbiAgICAgIHt0aGlzLnByb3BzLmJvb2suZHJhZnQuY2hhcHRlcnNbcHJvcHMuY2xLZXldLnRpdGxlfVxuICAgIDwvbGk+XG4gICk7XG5cbiAgLyoqXG4gICAqIGNoYXB0ZXJMaXN0IGlzIGFuIGFycmF5IG9mIHRoZSBpZCBrZXlzIG9mIGFsbCB0aGUgY2hhcHRlcnMuXG4gICAqIGNsS2V5IC0+IGNoYXB0ZXJMaXN0S2V5XG4gICAqL1xuICBTb3J0YWJsZUxpc3QgPSBTb3J0YWJsZUNvbnRhaW5lcigoeyBjaGFwdGVyTGlzdCB9KSA9PiB7XG4gICAgcmV0dXJuIChcbiAgICAgIDx1bCBjbGFzc05hbWU9XCJjaGFwdGVyLWxpc3RcIj5cbiAgICAgICAge2NoYXB0ZXJMaXN0Lm1hcCgoY2xLZXksIGluZGV4KSA9PlxuICAgICAgICAgIDx0aGlzLlNvcnRhYmxlSXRlbSBrZXk9e2NsS2V5fSBpbmRleD17aW5kZXh9IGNsS2V5PXtjbEtleX0gLz5cbiAgICAgICAgKX1cbiAgICAgIDwvdWw+XG4gICAgKTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIFRoaXMgaXMgd2hhdCBoYXBwZW5zIGFmdGVyIG91ciBhcnJheXMgYXJlIGRvbmUgbW92aW5nLlxuICAgKi9cbiAgb25Tb3J0RW5kID0gKHsgb2xkSW5kZXgsIG5ld0luZGV4IH0pID0+IHtcbiAgICAvLyBQZXJmb3JtIHRoZSByZWFycmFuZ2VtZW50XG4gICAgY29uc3QgY2hhcHRlckxpc3QgPVxuICAgICAgYXJyYXlNb3ZlKHRoaXMucHJvcHMuYm9vay5kcmFmdC5jaGFwdGVyTGlzdCwgb2xkSW5kZXgsIG5ld0luZGV4KTtcbiAgICAvLyBVcGRhdGUgdGhlIGRyYWZ0XG4gICAgY29uc3QgZHJhZnQgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnByb3BzLmJvb2suZHJhZnQpO1xuICAgIGRyYWZ0LmNoYXB0ZXJMaXN0ID0gY2hhcHRlckxpc3Q7XG4gICAgdGhpcy5wcm9wcy5tZXRob2RzLnNhdmVEcmFmdChkcmFmdCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEVuZCBkcmFnIGFuZCBkcm9wIGZ1bmN0aW9uYWxpdHlcbiAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gIGhhbmRsZVNlYXJjaENsaWNrID0gKCkgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc2hvd1NlYXJjaDogIXRoaXMuc3RhdGUuc2hvd1NlYXJjaFxuICAgIH0pO1xuICB9O1xuXG4gIGhhbmRsZVNlYXJjaElucHV0Q2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBzZWFyY2hUZXJtOiBldmVudC50YXJnZXQudmFsdWVcbiAgICB9KTtcbiAgfTtcblxuICByZW5kZXJTZWFyY2ggPSAoKSA9PiB7XG4gICAgcmV0dXJuICh0aGlzLnN0YXRlLnNob3dTZWFyY2gpID9cbiAgICAgIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjaGFwdGVyLXNlYXJjaFwiPlxuICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJTZWFyY2ggYm9vay4uLlwiXG4gICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVTZWFyY2hJbnB1dENoYW5nZX1cbiAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnNlYXJjaFRlcm19XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8aVxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiaWNvbiBpb24taW9zLWNsb3NlLW91dGxpbmVcIlxuICAgICAgICAgICAgb25DbGljaz17KCkgPT4gdGhpcy5zZXRTdGF0ZSh7IHNlYXJjaFRlcm06ICcnIH0pfVxuICAgICAgICAgIC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKSA6IG51bGw7XG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnNvbGUubG9nKCdSZW5kZXJpbmcgQm9va0VkaXRDaGFwdGVyU2lkZWJhcicpO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInNpZGViYXItY2hhcHRlcnMtY29udGFpbmVyXCI+XG4gICAgICAgIHt0aGlzLnJlbmRlclNlYXJjaCgpfVxuICAgICAgICA8dGhpcy5Tb3J0YWJsZUxpc3RcbiAgICAgICAgICBjaGFwdGVyTGlzdD17dGhpcy5wcm9wcy5ib29rLmRyYWZ0LmNoYXB0ZXJMaXN0fVxuICAgICAgICAgIG9uU29ydEVuZD17dGhpcy5vblNvcnRFbmR9XG4gICAgICAgICAgdXNlRHJhZ0hhbmRsZT17dHJ1ZX1cbiAgICAgICAgLz5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjaGFwdGVyLWFjdGlvbi1pY29uc1wiPlxuICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ0bi1zdWNjZXNzXCJcbiAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMucHJvcHMubWV0aG9kcy5oYW5kbGVDcmVhdGVDaGFwdGVyKCl9XG4gICAgICAgICAgPlxuICAgICAgICAgICAgTkVXXG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuLWRhbmdlclwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB0aGlzLnByb3BzLm1ldGhvZHMuaGFuZGxlRGVsZXRlQ2hhcHRlcigpfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImljb24gaW9uLXRyYXNoLWJcIiAvPlxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCBDaGFwdGVyU2lkZWJhcjtcbiJdfQ==